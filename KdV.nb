(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12113,        276]
NotebookOptionsPosition[     11664,        256]
NotebookOutlinePosition[     12020,        272]
CellTagsIndexPosition[     11977,        269]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Reproducing the Zabusky & Kruskal KdV simulation (1965)", "Subsection",
 CellChangeTimes->{{3.6333193326868896`*^9, 3.633319354207141*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"ZabuskyKruskalKdV", "=", 
    RowBox[{"NDSolveValue", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"\[PartialD]", 
            RowBox[{"u", "(", 
             RowBox[{"t", ",", "x"}], ")"}]}], 
           RowBox[{"\[PartialD]", "t"}],
           MultilineFunction->None], "+", 
          RowBox[{
           RowBox[{"u", "(", 
            RowBox[{"t", ",", "x"}], ")"}], " ", 
           FractionBox[
            RowBox[{"\[PartialD]", 
             RowBox[{"u", "(", 
              RowBox[{"t", ",", "x"}], ")"}]}], 
            RowBox[{"\[PartialD]", "x"}],
            MultilineFunction->None]}], "+", 
          RowBox[{
           SuperscriptBox["0.022", "2"], " ", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[PartialD]", "3"], 
             RowBox[{"u", "(", 
              RowBox[{"t", ",", "x"}], ")"}]}], 
            RowBox[{"\[PartialD]", 
             SuperscriptBox["x", "3"]}],
            MultilineFunction->None]}]}], "\[LongEqual]", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"u", "(", 
          RowBox[{"0", ",", "x"}], ")"}], "\[LongEqual]", 
         RowBox[{"cos", "(", 
          RowBox[{"\[Pi]", " ", "x"}], ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"u", "(", 
          RowBox[{"t", ",", "0"}], ")"}], "\[LongEqual]", 
         RowBox[{"u", "(", 
          RowBox[{"t", ",", "2"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"\[PartialD]", 
             RowBox[{"u", "(", 
              RowBox[{"t", ",", "x"}], ")"}]}], 
            RowBox[{"\[PartialD]", "x"}],
            MultilineFunction->None], "/.", "\[VeryThinSpace]", 
           RowBox[{"x", "\[Rule]", "0"}]}], ")"}], "\[LongEqual]", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"\[PartialD]", 
             RowBox[{"u", "(", 
              RowBox[{"t", ",", "x"}], ")"}]}], 
            RowBox[{"\[PartialD]", "x"}],
            MultilineFunction->None], "/.", "\[VeryThinSpace]", 
           RowBox[{"x", "\[Rule]", "2"}]}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             SuperscriptBox["\[PartialD]", "2"], 
             RowBox[{"u", "(", 
              RowBox[{"t", ",", "x"}], ")"}]}], 
            RowBox[{
             RowBox[{"\[PartialD]", "x"}], "\[ThinSpace]", 
             RowBox[{"\[PartialD]", "x"}]}],
            MultilineFunction->None], "/.", "\[VeryThinSpace]", 
           RowBox[{"x", "\[Rule]", "0"}]}], ")"}], "\[LongEqual]", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             SuperscriptBox["\[PartialD]", "2"], 
             RowBox[{"u", "(", 
              RowBox[{"t", ",", "x"}], ")"}]}], 
            RowBox[{
             RowBox[{"\[PartialD]", "x"}], "\[ThinSpace]", 
             RowBox[{"\[PartialD]", "x"}]}],
            MultilineFunction->None], "/.", "\[VeryThinSpace]", 
           RowBox[{"x", "\[Rule]", "2"}]}], ")"}]}]}], "\[IndentingNewLine]", 
       "}"}], ",", "\[IndentingNewLine]", "u", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", 
        FractionBox["3.6", "\[Pi]"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "2"}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<PDEDiscretization\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<MethodOfLines\>\"", ",", 
           RowBox[{"\"\<SpatialDiscretization\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<TensorProductGrid\>\"", ",", 
              RowBox[{"\"\<MinPoints\>\"", "\[Rule]", "1000"}]}], "}"}]}]}], 
          "}"}]}], "}"}]}]}], "]"}]}], ";"}], TraditionalForm]], "Input",
 CellChangeTimes->{{3.632590276099168*^9, 3.632590278250791*^9}, {
   3.632590331395162*^9, 3.632590364933757*^9}, {3.632590406261752*^9, 
   3.632590416488695*^9}, {3.632625094402261*^9, 3.632625120689723*^9}, {
   3.632625189900176*^9, 3.6326252098422747`*^9}, {3.632625251413278*^9, 
   3.632625290037956*^9}, 3.632625350927416*^9, {3.632625443437796*^9, 
   3.63262544412494*^9}, {3.6326254924544897`*^9, 3.632625513994815*^9}, {
   3.632625606603333*^9, 3.632625616963634*^9}, {3.632626041563326*^9, 
   3.632626065396101*^9}, {3.6326261095546923`*^9, 3.6326261150645103`*^9}, {
   3.632626152770834*^9, 3.632626179978635*^9}, {3.632626376321237*^9, 
   3.632626404392312*^9}, {3.632626441062899*^9, 3.632626482073193*^9}, {
   3.632626528719993*^9, 3.632626562341167*^9}, {3.633083988128045*^9, 
   3.633083988288045*^9}, {3.633084018810688*^9, 3.633084025481914*^9}, {
   3.633084116594327*^9, 3.633084154109089*^9}, {3.633084307751152*^9, 
   3.6330843086516953`*^9}, {3.633084371697178*^9, 3.633084396336404*^9}, {
   3.6330844402650433`*^9, 3.633084443949913*^9}, {3.633084605695538*^9, 
   3.6330846180617247`*^9}, {3.633085691796833*^9, 3.633085700337126*^9}, {
   3.633085780367372*^9, 3.6330857811344633`*^9}, {3.633085900444413*^9, 
   3.6330859132171507`*^9}, {3.633085975065968*^9, 3.6330860010788183`*^9}, {
   3.6330860941161127`*^9, 3.633086096940158*^9}, 3.6330861497727957`*^9, {
   3.633086212432045*^9, 3.6330862342185373`*^9}, {3.633086295944544*^9, 
   3.633086296159602*^9}, {3.633086574047756*^9, 3.6330865776073523`*^9}, {
   3.633086660373885*^9, 3.633086660686631*^9}, {3.6330870651258163`*^9, 
   3.633087074143824*^9}, {3.633087122371736*^9, 3.6330871401569843`*^9}, {
   3.633087203067686*^9, 3.633087203898383*^9}, {3.633087324910812*^9, 
   3.633087329024653*^9}, {3.633106386911026*^9, 3.633106389662958*^9}, {
   3.6331064930026407`*^9, 3.633106525823826*^9}, {3.633106797070796*^9, 
   3.633106815642948*^9}, {3.63310687005816*^9, 3.633106879418421*^9}, {
   3.63310719527494*^9, 3.633107227404716*^9}, {3.633143731007551*^9, 
   3.63314373850296*^9}, 3.633231421474256*^9, {3.633231452228059*^9, 
   3.633231465691094*^9}, {3.633231566751899*^9, 3.6332315668093567`*^9}, {
   3.6332329136936913`*^9, 3.63323295804276*^9}, {3.6332330115527678`*^9, 
   3.6332330196867733`*^9}, {3.633234084878821*^9, 3.633234098518906*^9}, {
   3.633246987554348*^9, 3.633247008326906*^9}, {3.633247040870702*^9, 
   3.633247067377108*^9}, 3.633247223989167*^9, {3.6332472920655746`*^9, 
   3.6332472921753798`*^9}, {3.633247330392951*^9, 3.6332473635263367`*^9}, {
   3.6332473999315968`*^9, 3.633247459579126*^9}, {3.633247545365753*^9, 
   3.633247546947043*^9}, 3.6332476000497103`*^9, 3.6332476668730593`*^9, {
   3.633247715362321*^9, 3.6332477197110863`*^9}, {3.633247834143392*^9, 
   3.6332478342542353`*^9}, {3.6332827395247*^9, 3.6332827412799597`*^9}, {
   3.633282785946806*^9, 3.633282801120495*^9}, {3.633282833093788*^9, 
   3.63328285086804*^9}, {3.6332828959007597`*^9, 3.633282914600933*^9}, 
   3.6332829541373577`*^9, {3.633282987021617*^9, 3.633282987123055*^9}, {
   3.6332830186267977`*^9, 3.633283019043022*^9}, {3.633319358190843*^9, 
   3.633319410722332*^9}, 3.6333195049413843`*^9}],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"ZabuskyKruskalKdV", "[", 
    RowBox[{"t", ",", "x"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", 
     FormBox[
      FractionBox["3.6", "\[Pi]"],
      TraditionalForm]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"t", ",", "x", ",", "u"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6333194002378387`*^9, 3.6333194165577927`*^9}}],

Cell[BoxData[
 RowBox[{"DensityPlot", "[", 
  RowBox[{
   RowBox[{"ZabuskyKruskalKdV", "[", 
    RowBox[{"t", ",", "x"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", 
     FormBox[
      FractionBox["3.6", "\[Pi]"],
      TraditionalForm]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"PlotPoints", "\[Rule]", "50"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.632625141630385*^9, 3.6326251731396923`*^9}, 
   3.632625360718012*^9, {3.632625521688642*^9, 3.6326255556956472`*^9}, {
   3.632625603622581*^9, 3.632625625311431*^9}, 3.633084039269588*^9, {
   3.633084175152671*^9, 3.633084177380251*^9}, 3.633084316167254*^9, 
   3.633084407115347*^9, {3.63308458368719*^9, 3.6330845864203787`*^9}, {
   3.633085730643317*^9, 3.633085731898529*^9}, 3.633085763472192*^9, {
   3.633085934648253*^9, 3.6330859373340693`*^9}, {3.633086157535049*^9, 
   3.633086158503704*^9}, 3.6330862486857777`*^9, {3.633086300661743*^9, 
   3.6330863007689943`*^9}, {3.633086614446824*^9, 3.633086614654269*^9}, {
   3.63308678859734*^9, 3.633086788849062*^9}, 3.633087191531321*^9, 
   3.6330873337983103`*^9, 3.6331064204821777`*^9, 3.6331069260460243`*^9, 
   3.633143745661674*^9, {3.633231477937848*^9, 3.63323153247206*^9}, {
   3.633247140510447*^9, 3.633247174442287*^9}, 3.633247234637126*^9, {
   3.633247350976933*^9, 3.6332473519579563`*^9}, 3.633247575995658*^9, {
   3.633247679967939*^9, 3.6332477370668583`*^9}, {3.633247874443548*^9, 
   3.633247875773425*^9}, {3.633282858027566*^9, 3.633282879423613*^9}, {
   3.633282946776616*^9, 3.633282947062368*^9}, 3.633282995430664*^9, {
   3.633319403662067*^9, 3.633319418910035*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"ZabuskyKruskalKdV", "[", 
      RowBox[{"t", ",", "x"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "2"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", 
     FormBox[
      FractionBox["3.6", "\[Pi]"],
      TraditionalForm]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.633086538927652*^9, 3.633086540030151*^9}, {
   3.633086621132861*^9, 3.63308662129445*^9}, {3.633086795891041*^9, 
   3.633086796157076*^9}, 3.633087162028603*^9, {3.633087268112311*^9, 
   3.633087297026523*^9}, {3.633087339333825*^9, 3.633087343685706*^9}, {
   3.633087471730205*^9, 3.633087482321306*^9}, 3.633106413626443*^9, {
   3.633106451067658*^9, 3.633106480685533*^9}, 3.6331069396943817`*^9, {
   3.633107248911409*^9, 3.63310729762504*^9}, {3.633108754242036*^9, 
   3.6331087662769737`*^9}, 3.633143750025017*^9, {3.633232991658883*^9, 
   3.6332329918405523`*^9}, {3.633247103364583*^9, 3.633247107613246*^9}, {
   3.6332472450506077`*^9, 3.63324725522139*^9}, 3.633247586368318*^9, 
   3.633247695631029*^9, {3.6332477530513487`*^9, 3.6332477532247133`*^9}, {
   3.6332477833958693`*^9, 3.633247801349835*^9}, {3.6332478581370363`*^9, 
   3.633247858328574*^9}, {3.63328292475177*^9, 3.633282958987*^9}, 
   3.633319436391279*^9}]
}, Open  ]]
},
WindowSize->{1225, 689},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 145, 1, 44, "Subsection"],
Cell[728, 25, 7261, 149, 247, "Input"],
Cell[7992, 176, 578, 16, 49, "Input"],
Cell[8573, 194, 1693, 30, 49, "Input"],
Cell[10269, 226, 1379, 27, 49, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

